description = "NLP 文本分析 - 深度分析文本的语言特征"

prompt = """
使用 novel analyze CLI 命令对文本进行 NLP 分析，提取词汇、句法、情感三维度特征。

用户输入：{{args}}

## 任务目标

对文本进行科学的 NLP 分析，提取量化的语言特征：
- **词汇分析**：分词、词频、词汇丰富度
- **句法分析**：句长统计、句式分布、标点模式
- **情感分析**：情感倾向、情感得分

## 执行步骤

### 1. 确认文件路径
询问用户要分析的文件路径（如果未提供）。
建议使用预处理后的文件：`clean/作者名/书名.txt`

### 2. 执行 NLP 分析命令
运行以下命令：
```bash
novel analyze <file> --verbose
```

示例：
```bash
novel analyze clean/jinyong/射雕英雄传.txt --verbose
```

### 3. 解读分析结果

#### 词汇分析
- **总词数**：文本包含的总词汇数量
- **唯一词数**：不重复的词汇数量
- **词汇丰富度 (TTR)**：唯一词数 / 总词数
  - < 10%：较低（长文本常见）
  - 10-20%：正常（典型小说范围）
  - 20-30%：较高（词汇丰富）
  - > 30%：很高（短文本或学术文本）
- **高频词 Top 20**：最常用的词汇及出现次数

#### 句法分析
- **总句数**：文本包含的句子数量
- **平均句长**：每句平均字符数
  - < 10 字：短句为主（节奏快）
  - 10-20 字：中等句长（平衡流畅）
  - > 20 字：长句为主（详细缓慢）
- **标准差**：句长变化程度（节奏感）
- **句长分布**：
  - 短句 (< 10字)：占比
  - 中句 (10-20字)：占比
  - 长句 (> 20字)：占比
- **标点符号**：各类标点的使用频率

#### 情感分析
- **情感倾向**：positive (积极) / neutral (中性) / negative (消极)
- **情感得分**：-1.0 到 +1.0
  - > 0.3：积极正面
  - -0.3 ~ 0.3：中性客观
  - < -0.3：消极负面
- **情感词汇**：积极词和消极词列表

### 4. 保存分析结果（可选）
如果用户需要保存详细结果：
```bash
novel analyze <file> -o nlp/<作者名>/<书名>.json
```

示例：
```bash
novel analyze clean/jinyong/射雕英雄传.txt -o nlp/jinyong/射雕英雄传.json
```

### 5. 生成分析报告
创建易读的分析报告：
```markdown
## NLP 分析报告：[书名]

### 词汇特征
- 总词数：[数据]
- 唯一词数：[数据]
- 词汇丰富度：[数据] ([评级])
- 高频词：[列表前10个]

### 句法特征
- 平均句长：[数据] 字 ([类型])
- 句长分布：短句 [%] / 中句 [%] / 长句 [%]
- 节奏感：[评估]

### 情感特征
- 情感倾向：[倾向] ([得分])
- 主要情感词：[列表]

### 风格总结
[基于数据的风格描述]
```

### 6. 建议下一步
根据分析结果：
- 如果是样本文本：建议使用 /style-learn 学习风格
- 如果是创作文本：建议使用 /style-check 检测一致性

## 性能指标

- 分析速度：10,000 字 ≈ 57ms
- 准确率：基于 jieba 分词（90%+）

## 批量分析示例

如果用户需要分析多个文件：
```bash
# Windows PowerShell
Get-ChildItem clean/jinyong/*.txt | ForEach-Object {
  novel analyze $_.FullName -o "nlp/jinyong/$($_.BaseName).json"
}

# Unix/Linux/Mac
for file in clean/jinyong/*.txt; do
  novel analyze "$file" -o "nlp/jinyong/$(basename "$file" .txt).json"
done
```

## 分析结果应用

NLP 分析结果可用于：
1. **风格学习**：为 AI 提供量化的风格特征
2. **风格对比**：比较不同作者的写作差异
3. **质量评估**：评估文本的语言质量
4. **创作指导**：指导后续创作的语言风格

## 常见问题处理

**问题1：分析速度慢**
- 原因：文本过长（> 100,000 字符）
- 解决：分段分析或先预处理

**问题2：词汇丰富度异常**
- 原因：文本长度或类型特殊
- 解决：参考同类型文本的正常范围

**问题3：情感分析不准确**
- 原因：基于情感词典，可能不适用特定文本
- 解决：作为参考，结合人工判断

## 完成提示
✅ NLP 分析完成！建议下一步：
- 样本文本 → 使用 /style-learn 学习风格
- 创作文本 → 使用 /style-check 检测一致性
"""
