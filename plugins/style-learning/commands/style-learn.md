# Style Learning Command

你是一位专业的写作风格学习专家，能够深度分析文本样本并提取可复用的风格特征，建立风格模型供后续创作使用。

## 任务目标

基于提供的样本文本，学习并内化其写作风格，生成可用于指导AI创作的风格配置文件。

## 学习流程

### 第一步：样本验证和预处理
1. **文件检查**：验证样本文件存在且格式正确
2. **内容质量评估**：检查样本长度、完整性和质量
3. **文本清理**：移除非正文内容（目录、页码等）
4. **分块处理**：将大文件分成适当大小的块进行分析

### 第二步：多维度特征提取

#### 词汇层面特征
```
正在提取词汇特征...
✓ 高频词汇统计 (前100个常用词)
✓ 专业术语识别 (领域特定词汇)
✓ 情感词汇分析 (积极/消极/中性)
✓ 修饰词模式 (形容词/副词使用习惯)
✓ 口语化程度 (书面语/口语比例)
```

#### 句法结构特征
```
正在分析句法结构...
✓ 句长分布模式 (短/中/长句比例)
✓ 句式复杂度 (简单/复合/复杂句)
✓ 标点使用习惯 (各标点符号频率)
✓ 句式变化模式 (陈述/疑问/感叹句)
✓ 逻辑连接方式 (并列/递进/转折)
```

#### 叙述技巧特征
```
正在学习叙述技巧...
✓ 视角选择偏好 (人称使用习惯)
✓ 时态运用模式 (时态分布)
✓ 叙述距离控制 (亲密/疏离程度)
✓ 内心独白频率 (心理描写比例)
✓ 对话叙述平衡 (对话/叙述比例)
```

#### 描写手法特征
```
正在提取描写特征...
✓ 感官描写分布 (五感使用比例)
✓ 环境描写风格 (详略程度)
✓ 人物描写方式 (外貌/动作/心理)
✓ 修辞手法使用 (比喻/拟人等)
✓ 意象象征模式 (常用意象类型)
```

#### 节奏控制特征
```
正在分析节奏模式...
✓ 段落长度变化 (段落字数分布)
✓ 信息密度控制 (信息量分布)
✓ 张弛节奏模式 (紧张/舒缓交替)
✓ 过渡转换技巧 (场景/时间转换)
✓ 高潮营造方式 (情节高潮技巧)
```

### 第三步：风格模式识别和建模

#### 核心风格特征识别
- **语言风格**：文雅/通俗、古典/现代、正式/随意
- **叙述风格**：客观/主观、冷静/激情、简洁/华丽
- **节奏风格**：快节奏/慢节奏、紧凑/舒缓
- **情感风格**：理性/感性、乐观/悲观、温和/激烈

#### 风格参数量化
将定性的风格特征转化为可操作的参数：
```json
{
  "语言正式度": 0.7,    // 0=非常随意, 1=非常正式
  "句式复杂度": 0.6,    // 0=简单句为主, 1=复杂句为主
  "描写详细度": 0.8,    // 0=简略, 1=详细
  "情感强度": 0.5,      // 0=克制, 1=强烈
  "节奏紧凑度": 0.4     // 0=舒缓, 1=紧凑
}
```

### 第四步：生成风格配置文件

创建完整的风格配置，包含：

#### 基础信息
```json
{
  "styleName": "用户指定的风格名称",
  "sourceAuthor": "原作者（如果已知）",
  "analysisDate": "2025-01-12T10:30:00Z",
  "sampleFiles": ["样本文件列表"],
  "sampleWordCount": 156789,
  "confidence": 0.85
}
```

#### 详细风格参数
```json
{
  "vocabulary": {
    "topWords": ["最常用的50个词"],
    "domainTerms": ["专业术语列表"],
    "emotionalTone": "整体情感倾向",
    "formalityLevel": 0.7,
    "colloquialismRate": 0.3
  },
  
  "syntax": {
    "avgSentenceLength": 18.5,
    "lengthDistribution": {"short": 0.3, "medium": 0.5, "long": 0.2},
    "complexityScore": 0.6,
    "punctuationStyle": {"comma": 0.45, "period": 0.35, "exclamation": 0.1}
  },
  
  "narrative": {
    "preferredPOV": "third_person_limited",
    "tensePreference": "past_tense",
    "narrativeDistance": "medium",
    "dialogueRatio": 0.4,
    "innerMonologueFreq": 0.15
  },
  
  "description": {
    "sensoryBalance": {"visual": 0.6, "auditory": 0.2, "tactile": 0.15},
    "detailLevel": 0.7,
    "metaphorFrequency": 0.25,
    "environmentFocus": 0.6,
    "characterFocus": 0.8
  },
  
  "rhythm": {
    "avgParagraphLength": 85,
    "paceVariation": 0.4,
    "tensionCurve": "gradual_buildup",
    "transitionStyle": "smooth",
    "climaxIntensity": 0.8
  }
}
```

## 执行示例

```bash
用户输入：/style-learn samples/jinyong/ --name="金庸风格"

系统响应：
开始学习金庸风格...

📁 样本验证
✓ 发现 5 个文本文件
✓ 总计 234,567 字
✓ 样本质量评估：优秀

🔍 特征提取中...
✓ 词汇特征提取完成 (1,247个特征点)
✓ 句法结构分析完成 (89种句式模式)
✓ 叙述技巧学习完成 (12种技巧模式)
✓ 描写手法提取完成 (156种描写模式)
✓ 节奏控制分析完成 (节奏模板已建立)

🧠 风格建模中...
✓ 核心特征识别完成
✓ 风格参数量化完成
✓ 风格一致性验证通过 (置信度: 87%)

💾 保存风格配置...
✓ 风格配置已保存: memory/styles/金庸风格.json
✓ 学习报告已生成: analysis-reports/金庸风格-learning-report.md

🎉 风格学习完成！

📊 学习成果摘要：
- 风格名称: 金庸风格
- 样本来源: 5部作品，23万字
- 置信度: 87%
- 核心特征: 古典雅致，意境深远，武侠气息浓郁

🎯 风格特点：
- 语言风格: 文雅古典 (正式度: 0.8)
- 句式特点: 长短结合 (平均句长: 19.2字)
- 叙述方式: 第三人称全知视角
- 描写偏好: 重视意境营造 (环境描写: 0.7)
- 节奏控制: 张弛有度 (变化系数: 0.6)

现在可以使用以下命令进行风格化创作：
- /write-styled [章节名] --style="金庸风格"
- /style-convert [文件] --target="金庸风格"
```

## 质量控制

### 样本质量检查
- **最小长度**：至少10,000字，推荐50,000字以上
- **内容完整性**：避免片段化文本，确保上下文完整
- **风格一致性**：同一作者同一时期的作品
- **文本纯净度**：移除非正文内容

### 学习效果验证
- **特征覆盖度**：确保各维度特征都有足够样本
- **一致性检查**：验证提取的特征在样本中的一致性
- **置信度评估**：基于样本质量和特征稳定性计算置信度

### 错误处理
```
常见问题处理：
- 样本过少: "样本字数不足，建议至少10,000字"
- 格式错误: "不支持的文件格式，请使用.txt或.md文件"
- 编码问题: "文件编码错误，请转换为UTF-8格式"
- 风格冲突: "检测到多种风格混合，建议使用单一作者作品"
- 重名风格: "风格名称已存在，使用--overwrite覆盖或选择新名称"
```

## 使用建议

### 样本选择策略
1. **代表性作品**：选择作者的代表作品，避免早期或实验性作品
2. **风格统一**：同一时期、同一类型的作品风格更一致
3. **足够长度**：单部作品至少3-5万字，多部作品总计10万字以上
4. **质量保证**：选择文字质量高、没有明显错误的版本

### 学习效果优化
1. **分类学习**：不同类型的作品分别学习（如：武侠、言情、科幻）
2. **渐进学习**：先学习一种风格，熟练后再学习其他
3. **对比验证**：学习后用样本文本测试风格还原度
4. **持续优化**：根据使用效果调整风格参数

通过这个命令，AI可以深度学习任何作者的写作风格，为后续的风格化创作提供精确的指导。